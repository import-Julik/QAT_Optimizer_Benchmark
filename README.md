# QAT Optimizer Benchmark (LSQ)
### Benchmarking Optimization Methods for Quantization-Aware Training with LSQ on ESPCN (DIV2K) and ResNet-18 (ThuDogs)

---

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤–ª–∏—è–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–æ–≤ –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π –ø—Ä–∏ **Quantization-Aware Training (QAT)** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Learned Step Size Quantization (LSQ)**.

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –¥–≤–µ –∑–∞–¥–∞—á–∏:

- **Super-Resolution**
  - –º–æ–¥–µ–ª—å: **ESPCN (LSQ)**
  - –¥–∞—Ç–∞—Å–µ—Ç: **DIV2K**
  - –º–µ—Ç—Ä–∏–∫–∞: **PSNR**

- **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è**
  - –º–æ–¥–µ–ª—å: **ResNet-18 (LSQ)**
  - –¥–∞—Ç–∞—Å–µ—Ç: **ThuDogs**
  - –º–µ—Ç—Ä–∏–∫–∞: **Accuracy**

–¶–µ–ª—å ‚Äî –ø–æ–Ω—è—Ç—å —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å —Ä–∞–∑–Ω—ã—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–æ–≤ –∫ –∫–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–º—É —à—É–º—É.

---

# –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä—ã –≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–µ (10 —à—Ç.)

| ‚Ññ | –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä |
|---|-------------|
| 1 | Adam | 
| 2 | AdamW | 
| 3 | RMSProp |
| 4 | AdaGrad | 
| 5 | Adadelta | 
| 6 | SGD | 
| 7 | Nesterov |
| 8 | Lion | 
| 9 | SGD + Gradient Clipping | 
|10 | Adaptive Gradient Clipping (AGC) | 

---

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã: Super-Resolution (DIV2K, ESPCN-LSQ)

–ú–µ—Ç—Ä–∏–∫–∞: PSNR  (—Å—Ä–µ–¥–Ω–µ–µ –ø–æ 10 –∑–∞–ø—É—Å–∫–∞–º)

| –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä | PSNR |
|-------------|-------|
| **AdamW** | **21.7968** |
| **Adam** | **21.6762** |
| RMSprop | 21.3211 |
| AdaGrad | 20.3651 |
| Lion | 17.7479 |
| Nesterov | 14.2598 |
| SGD_GCM | 13.1684 |
| SGD | 13.1684 |
| AGC_SGD | 6.4209 |
| Adadelta | 6.2298 |

---

# üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã: Classification (ThuDogs, ResNet18-LSQ)

–ú–µ—Ç—Ä–∏–∫–∞: Accuracy ‚Üë (—Å—Ä–µ–¥–Ω–µ–µ –ø–æ 10 –∑–∞–ø—É—Å–∫–∞–º)

| –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä | Accuracy |
|-------------|----------|
| **AdaGrad** | **4.615%** |
| Adam | 3.846% |
| AdamW | 3.076% |
| AGC_SGD | 2.307% |
| Adadelta | 2.307% |
| Lion | 2.307% |
| Nesterov | 2.307% |
| RMSprop | 2.307% |
| SGD | 2.307% |
| SGD_GCM | 1.538% |

---

# –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

###  1. –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä—ã —É—Å—Ç–æ–π—á–∏–≤–µ–µ –∫ —à—É–º—É LSQ  
AdamW, Adam –∏ RMSprop –ø–æ–∫–∞–∑–∞–ª–∏ –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –æ–±–µ–∏—Ö –∑–∞–¥–∞—á–∞—Ö.  
–≠—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ:

- LSQ —Å–æ–∑–¥–∞—ë—Ç –≤—ã—Å–æ–∫–æ–¥–∏—Å–ø–µ—Ä—Å–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç  
- –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –ª—É—á—à–µ –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç –º–∞—Å—à—Ç–∞–± –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞  
- AdamW —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç —à–∞–≥ –∑–∞ —Å—á—ë—Ç weight decay

###  2. SGD-–ø–æ–¥–æ–±–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Å–∏–ª—å–Ω–æ –¥–µ–≥—Ä–∞–¥–∏—Ä—É—é—Ç  
SGD, Nesterov –∏ Lion –ø–ª–æ—Ö–æ —Å–ø—Ä–∞–≤–ª—è—é—Ç—Å—è, —Ç.–∫.:

- —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –∫ –º–∞—Å—à—Ç–∞–±–∞–º —à—É–º–Ω—ã—Ö –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤
- —É LSQ –Ω–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ ‚Üí –ø–ª–æ—Ö–∞—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å
- momentum –∑–∞–≥—Ä—è–∑–Ω—è–µ—Ç—Å—è –∫–≤–∞–Ω—Ç–æ–≤—ã–º–∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º–∏

### 3. –®—É–º–æ—É—Å—Ç–æ–π—á–∏–≤—ã–µ –º–µ—Ç–æ–¥—ã (AGC, GCM) —Ä–∞–±–æ—Ç–∞—é—Ç —Ö—É–∂–µ –≤—Å–µ—Ö  
–í–∞–∂–Ω–æ: **—ç—Ç–æ –ù–ï –æ—à–∏–±–∫–∞**, –∞ –Ω–∞—É—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

–ü—Ä–∏—á–∏–Ω–∞:

- AGC/GCM —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ *–æ–≥—Ä–æ–º–Ω—ã—Ö –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤*
- –≤ LSQ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –¥—Ä—É–≥–æ–µ ‚Üí –æ–Ω–∏ —Ä–µ–∂—É—Ç –ø–æ–ª–µ–∑–Ω—ã–π —Å–∏–≥–Ω–∞–ª
- –º–æ–¥–µ–ª—å –≤—Ö–æ–¥–∏—Ç –≤ —Ä–µ–∂–∏–º —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–æ–≥–æ –Ω–µ–¥–æ–æ–±—É—á–µ–Ω–∏—è

---

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è

- –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—è (6 —ç–ø–æ—Ö √ó 10 –∑–∞–ø—É—Å–∫–æ–≤)
- —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (ESPCN –∏ ResNet18)
- —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ö–µ–º–∞ LSQ
- –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ batch size –∏ learning rate

---

# –í—ã–≤–æ–¥—ã

- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã (AdamW, Adam) –Ω–∞–∏–±–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤—ã –∫ —à—É–º–Ω—ã–º LSQ-–≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º  
- SGD-–ø–æ–¥–æ–±–Ω—ã–µ –º–µ—Ç–æ–¥—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–µ–∑–∫–æ–µ –ø–∞–¥–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞  
- –®—É–º–æ—É—Å—Ç–æ–π—á–∏–≤—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä—ã AGC/GCM **–Ω–µ–ø–µ—Ä–µ–Ω–æ—Å–∏–º—ã** –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è  
- –ù–∏–∑–∫–∏–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ QAT —Å LSQ –Ω–∞ —Ä–∞–Ω–Ω–∏—Ö —ç–ø–æ—Ö–∞—Ö  
- –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤–∞–ª–∏–¥–Ω–æ, —Ç.–∫. —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –≤ **—Ä–∞–≤–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö**

